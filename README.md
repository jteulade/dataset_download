# Sentinel Data Download Tool

A simple tool to explore Sentinel-2 data for cities and download Sentinel-2 tiles.

## Prerequisites

- Python 3.6 or higher
- Required Python packages: see `requirements.txt`

## Installation

1. Clone or download this repository
2. Install the required packages:
   ```
   pip install -r requirements.txt
   ```
3. Make the scripts executable:
   ```
   chmod +x scripts/*.py
   ```

## Authentication

To download tiles, you need a valid Copernicus Data Space API token:

1. Register for an account at [Copernicus Data Space Ecosystem](https://dataspace.copernicus.eu/)
2. The scripts will automatically handle token generation and refresh

## Main Scripts

### 1. City Explorer (`scripts/sentinel_city_explorer.py`)

This script queries Sentinel-2 Global Mosaics data for cities.

#### Basic Usage

```bash
python scripts/sentinel_city_explorer.py --cities-csv worldcities.csv --num-cities 5
```

#### Key Arguments

- `--cities-csv`: Path to the CSV file containing city data (required)
- `--num-cities`: Number of cities to select (default: 20)
- `--population-min`: Minimum population threshold for cities (default: 500000)
- `--year-filter`: Year to filter for (default: "2023")
- `--random-distance`: Distance in kilometers for random points from cities (default: 100)
- `--ensure-on-land`: Only generate random points on land (default: True)

#### Output

- A CSV file with the selected cities
- JSON files with the query results

### 2. Tile Downloader (`scripts/download_from_json.py`)

This script downloads Sentinel-2 tiles from JSON files generated by the city explorer.

#### Basic Usage

```bash
python scripts/download_from_json.py --json-file results/your_generated_file.json --output-dir downloads
```

#### Key Arguments

- `--json-file`: Path to the JSON file containing tile information (required)
- `--output-dir`: Directory to save downloaded files (default: "downloads")

### 3. Map Visualizer (`scripts/visualize_quarterly_products.py`)

This script creates an interactive map to visualize Sentinel-2 Global Mosaics quarterly products and their footprints.

#### Basic Usage

```bash
python scripts/visualize_quarterly_products.py --input-json results/your_generated_file.json --output-map maps/quarterly_products_map.html
```

#### Key Arguments

- `--input-json`: Path to the JSON file containing quarterly products (required)
- `--output-map`: Path to save the HTML map file (default: "maps/quarterly_products_map.html")

## Example Workflow

1. Run the city explorer to find Sentinel-2 data:
   ```bash
   python scripts/sentinel_city_explorer.py --cities-csv worldcities.csv --num-cities 3
   ```

2. Use the output JSON file to download the tiles:
   ```bash
   python scripts/download_from_json.py --json-file results/S2_GlobalMosaics_2023_unified_[timestamp].json --output-dir downloads
   ```

3. Visualize the results:
   ```bash
   python scripts/visualize_quarterly_products.py --input-json results/S2_GlobalMosaics_2023_unified_[timestamp].json
   ```

## Directory Structure

```
./
├── scripts/                     # Executable scripts
│   ├── sentinel_city_explorer.py    # Script to find Sentinel-2 data for cities
│   ├── download_from_json.py        # Script to download Sentinel-2 tiles
│   └── visualize_quarterly_products.py  # Script to visualize quarterly products
├── src/                         # Source code package
│   ├── city_selector.py        # City selection functionality
│   ├── map_visualizer.py       # Map visualization functionality
│   ├── sentinel_query.py       # Sentinel-2 query functionality
│   ├── sentinel_tile_downloader.py  # Tile download functionality
│   └── token_manager.py        # Token management functionality
├── requirements.txt             # Project dependencies
├── worldcities.csv              # Dataset of world cities
├── data/                        # Data storage
├── results/                     # Results storage
├── maps/                        # Generated map files
└── downloads/                   # Downloaded tiles storage
```

## License

This project is open source and available under the MIT License. 